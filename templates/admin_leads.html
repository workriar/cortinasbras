<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin - Leads | Cortinas Brás</title>
  <link rel="icon" href="/static/favicon.ico">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    .table-dark {
      --bs-table-bg: rgba(255, 255, 255, 0.03);
      --bs-table-striped-bg: rgba(255, 255, 255, 0.05);
      --bs-table-hover-bg: rgba(255, 255, 255, 0.08);
      color: var(--text);
    }
  </style>
</head>
<body>
  <div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h1 class="text-gold">Leads Recebidos</h1>
      <a href="/" class="btn btn-warning">← Voltar ao Site</a>
    </div>

    {% if leads %}
    <div class="table-responsive">
      <table class="table table-dark table-striped table-hover">
        <thead>
          <tr>
            <th>ID</th>
            <th>Data</th>
            <th>Nome</th>
            <th>Telefone</th>
            <th>Parede (L×A)</th>
            <th>Janela (L×A)</th>
            <th>Tecido</th>
            <th>Instalação</th>
            <th>Endereço</th>
            <th>Observações</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          {% for lead in leads %}
          <tr>
            <td>{{ lead.id }}</td>
            <td>{{ lead.criado_em.strftime('%d/%m/%Y %H:%M') }}</td>
            <td>{{ lead.nome }}</td>
            <td>
              <a href="https://wa.me/55{{ lead.telefone|replace('(', '')|replace(')', '')|replace('-', '')|replace(' ', '') }}" 
                 class="text-gold text-decoration-none" 
                 target="_blank">
                {{ lead.telefone }}
              </a>
            </td>
            <td>{{ "%.2f"|format(lead.largura_parede) }}m × {{ "%.2f"|format(lead.altura_parede) }}m</td>
            <td>{{ "%.2f"|format(lead.largura_janela) }}m × {{ "%.2f"|format(lead.altura_janela) }}m</td>
            <td>{{ lead.tecido }}</td>
            <td>{{ lead.instalacao }}</td>
            <td>{{ lead.endereco if lead.endereco else '-' }}</td>
            <td>{{ lead.observacoes if lead.observacoes else '-' }}</td>
            <td>
              <a href="/orcamento/{{ lead.id }}/pdf" class="btn btn-sm btn-warning">
                PDF
              </a>
              <a href="https://wa.me/55{{ lead.telefone|replace('(', '')|replace(')', '')|replace('-', '')|replace(' ', '') }}?text={{ whatsapp_message(lead)|urlencode }}" 
                 class="btn btn-sm btn-success" 
                 target="_blank">
                WhatsApp
              </a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="alert alert-info">
      <p class="mb-0">Nenhum lead recebido ainda.</p>
    </div>
    {% endif %}

    <div class="mt-4">
      <p class="text-muted">Total de leads: {{ leads|length }}</p>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
