# ğŸ”‘ Configurar Deploy Key - Passo a Passo

## Objetivo
Permitir que o EasyPanel faÃ§a pull do repositÃ³rio GitHub configurando uma Deploy Key SSH.

---

## ğŸ“‹ Passo 1: Obter a Deploy Key do EasyPanel

### 1.1 Acessar o Projeto no EasyPanel
1. Abra seu painel EasyPanel
2. Navegue atÃ© o projeto **cortinas-bresser** (ou nome do seu projeto)

### 1.2 Encontrar a Deploy Key
Dependendo da versÃ£o do EasyPanel, a chave pode estar em:

**OpÃ§Ã£o A - Aba Git/Repository:**
1. Clique na aba **"Git"** ou **"Repository"**
2. Procure por **"Deploy Key"** ou **"SSH Key"**
3. VocÃª verÃ¡ algo como:
   ```
   ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAB... easypanel@server
   ```

**OpÃ§Ã£o B - Settings:**
1. Clique em **"Settings"** do projeto
2. VÃ¡ em **"Git Settings"** ou **"Repository Settings"**
3. Procure por **"Public Key"** ou **"Deploy Key"**

**OpÃ§Ã£o C - Service Settings:**
1. Clique no serviÃ§o (cortinas-web)
2. VÃ¡ em **"Source"** ou **"Git"**
3. Procure por **"SSH Key"** ou **"Deploy Key"**

### 1.3 Copiar a Chave
1. **Copie toda a chave SSH** (comeÃ§a com `ssh-rsa` ou `ssh-ed25519`)
2. A chave deve ter este formato:
   ```
   ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDExampleKey1234567890...
   ```

> âš ï¸ **Importante:** Copie a chave **PÃšBLICA** (nÃ£o a privada)

---

## ğŸ“‹ Passo 2: Adicionar Deploy Key no GitHub

### 2.1 Acessar ConfiguraÃ§Ãµes do RepositÃ³rio
1. Abra: https://github.com/workriar/cortinasbras
2. Clique em **"Settings"** (Ã­cone de engrenagem no topo)

### 2.2 Adicionar Deploy Key
1. No menu lateral esquerdo, clique em **"Deploy keys"**
2. Clique no botÃ£o **"Add deploy key"** (canto superior direito)

### 2.3 Configurar a Deploy Key
Preencha o formulÃ¡rio:

**Title (TÃ­tulo):**
```
EasyPanel Deploy Key
```

**Key (Chave):**
```
[Cole aqui a chave SSH que vocÃª copiou do EasyPanel]
```

**Allow write access:**
- âœ… **NÃƒO marque** esta opÃ§Ã£o (o EasyPanel sÃ³ precisa ler)
- Marque apenas se o EasyPanel precisar fazer push (nÃ£o Ã© o caso)

### 2.4 Salvar
1. Clique em **"Add key"**
2. VocÃª verÃ¡ a chave listada com um Ã­cone verde âœ…

---

## ğŸ“‹ Passo 3: Testar o Deploy no EasyPanel

### 3.1 ForÃ§ar Rebuild
No EasyPanel:
1. Volte ao seu projeto
2. Clique em **"Rebuild"** ou **"Redeploy"**
3. Ou clique em **"Pull & Deploy"** se disponÃ­vel

### 3.2 Monitorar os Logs
1. VÃ¡ na aba **"Logs"** ou **"Build Logs"**
2. VocÃª deve ver:
   ```
   âœ… Pulling data from origin/main
   âœ… Successfully pulled changes
   âœ… Building Docker image...
   ```

### 3.3 Aguardar Deploy
- O deploy deve completar em 2-5 minutos
- Status deve mudar para **"Running"** ou **"Healthy"**

---

## ğŸ” VerificaÃ§Ã£o

### Se Funcionou:
- âœ… Logs mostram "Successfully pulled changes"
- âœ… Build inicia normalmente
- âœ… Container fica em estado "Running"
- âœ… Site estÃ¡ acessÃ­vel

### Se Ainda Falhar:
Verifique:
1. **Chave copiada corretamente?** (sem espaÃ§os extras)
2. **RepositÃ³rio Ã© privado?** (deploy key deve estar ativa)
3. **Branch correta?** (deve ser `main`)

---

## ğŸ†˜ Troubleshooting

### Erro: "Permission denied (publickey)"
**Causa:** Deploy key nÃ£o foi adicionada ou estÃ¡ incorreta

**SoluÃ§Ã£o:**
1. Verifique se a chave no GitHub estÃ¡ **exatamente** igual Ã  do EasyPanel
2. Certifique-se de copiar a chave **completa** (incluindo `ssh-rsa` no inÃ­cio)
3. Tente remover e adicionar a deploy key novamente

### Erro: "Repository not found"
**Causa:** URL do repositÃ³rio incorreta

**SoluÃ§Ã£o:**
1. No EasyPanel, verifique se a URL Ã©: `git@github.com:workriar/cortinasbras.git`
2. Ou tente com HTTPS: `https://github.com/workriar/cortinasbras.git`

### Erro: "Failed to pull changes" (ainda)
**Causa:** Pode haver conflitos ou problemas de rede

**SoluÃ§Ã£o:**
1. No EasyPanel, tente **"Force Rebuild"** ou **"Clean Build"**
2. Verifique se hÃ¡ opÃ§Ã£o de **"Reset to remote"** ou **"Hard reset"**

---

## ğŸ“¸ Capturas de Tela Ãšteis

### No GitHub - Deploy Keys:
VocÃª verÃ¡ algo assim apÃ³s adicionar:
```
âœ… EasyPanel Deploy Key
   ssh-rsa AAAAB3Nza...
   Added on Dec 18, 2025
   Never used / Last used: a few seconds ago
```

### No EasyPanel - Logs de Sucesso:
```
[INFO] Pulling data from origin/main
[INFO] From github.com:workriar/cortinasbras
[INFO]  * branch            main       -> FETCH_HEAD
[INFO] Already up to date.
[INFO] Building Docker image...
```

---

## âœ… Checklist Final

Antes de testar o deploy:
- [ ] Copiei a chave SSH pÃºblica do EasyPanel
- [ ] Adicionei a deploy key no GitHub (Settings â†’ Deploy keys)
- [ ] A chave estÃ¡ ativa no GitHub (Ã­cone verde)
- [ ] Cliquei em "Rebuild" no EasyPanel
- [ ] Estou monitorando os logs

---

## ğŸ‰ PrÃ³ximos Passos

ApÃ³s o deploy funcionar:
1. âœ… Verifique se o site estÃ¡ acessÃ­vel
2. âœ… Teste o formulÃ¡rio de orÃ§amento
3. âœ… Futuras alteraÃ§Ãµes farÃ£o deploy automÃ¡tico ao fazer `git push`

---

## ğŸ’¡ Dica para o Futuro

Agora que a deploy key estÃ¡ configurada:
```bash
# Sempre que fizer alteraÃ§Ãµes:
git add .
git commit -m "DescriÃ§Ã£o da alteraÃ§Ã£o"
git push origin main

# O EasyPanel detectarÃ¡ automaticamente e farÃ¡ deploy!
```

---

**RepositÃ³rio:** https://github.com/workriar/cortinasbras  
**Branch:** main  
**Deploy Key:** Configurada âœ…
